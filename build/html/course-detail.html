<ons-page class="card-view" ng-controller="CourseDetailController as courseDetail" ng-class="{student:main.currentStudent, ios:ons.platform.isIOS()}">
    <ons-toolbar ng-class="[courseDetail.courseColor(), {student:main.currentStudent, ios:ons.platform.isIOS()}]">
        <div class="left"><ons-back-button translate>Back</ons-back-button></div>
        <div class="center">{{::courseDetail.course.courseName}}</div>
    </ons-toolbar>
    <div class="course-summary" >
        <ons-row>
            <ons-col>
                <div class="course-header">
                    <div class="teacher" tappable ng-click="courseDetail.compose()">
                        <ons-ripple color="rgba(156, 156, 156, 0.20)"></ons-ripple>
                        <ons-icon icon="ion-ios-email" size="32px"></ons-icon>{{courseDetail.progress.teacher.name}}<span ng-show="courseDetail.progress.coTeacher"> - {{courseDetail.progress.coTeacher.name}}</span>
                    </div>
                    <div ng-if="courseDetail.progress.grades.length > 0">
                        <div class="category" translate>Last Progress Report:</div>
                        <div class="category">{{courseDetail.progress.date|date:"MMM d, y hh:mm a" : "UTC"}}</div>
                    </div>
                </div>
            </ons-col>
            <ons-col width="175px" ng-if="courseDetail.progress.grades.length > 0">
                <div class="grade-info" ng-show="courseDetail.hasGrade() === true || courseDetail.hasScore() === true" tappable
                                ng-click="courseNavigator.pushPage('course-info.html', {animation: 'slide', progress: courseDetail.progress, course: courseDetail.course})">
                    <div class="grade" ng-show="courseDetail.hasGrade() === true">{{courseDetail.getGrade()}}</div>
                    <div class="score" ng-show="courseDetail.hasScore() === true">{{courseDetail.getScore()}}<ons-icon class="nav-indicator" icon="ion-chevron-right" size="12px"></ons-icon></div>
                </div>
                <div class="grade-info" ng-show="courseDetail.zeroCount > 0">
                    <div class="zero"
                            ng-click="courseNavigator.pushPage('course-assignments.html', {animation: 'slide', filter: 'zeros', progress: courseDetail.progress, course: courseDetail.course})">
                        {{courseDetail.zeroCount}}</div>
                    <div class="score" ng-show="courseDetail.zeroCount == 1" translate>Zero<ons-icon class="nav-indicator" icon="ion-chevron-right" size="12px"></ons-icon></div>
                    <div class="score" ng-show="courseDetail.zeroCount > 1" translate>Zeros<ons-icon class="nav-indicator" icon="ion-chevron-right" size="12px"></ons-icon></div>
                </div>
            </ons-col>
        </ons-row>

        <div class="chart-holder" affix ng-show="courseDetail.progress.trendScores.length > 0">
            <flot class="flot-chart" dataset="courseDetail.chartData" options="courseDetail.options" height="100%"></flot>
        </div>
    </div>
    <ons-list>
        <ons-list-header ng-if="courseDetail.progress.grades.length > 0">
            Assignments
        </ons-list-header>
        <div class="card">
            <ons-list-item class="card-item course-detail" modifier="longdivider"
                           ng-if="courseDetail.progress.grades.length == 0">
                <div class="center">
                    <div class="status-message" translate>No Recent Scores</div>
                </div>
            </ons-list-item>
            <ons-list-item class="card-item course-detail" modifier="longdivider" tappable
                           ng-if="courseDetail.progress.grades.length > 0"
                           ng-click="courseNavigator.pushPage('course-assignments.html', {animation: 'slide', progress: courseDetail.progress, course: courseDetail.course})">
                <div class="right">
                    <div translate>View All Assignments<ons-icon class="nav-indicator" icon="ion-chevron-right" size="12px"></ons-icon></div>
                </div>
            </ons-list-item>
            <ons-list-item class="card-item course-detail" ng-class="{'zero-grade': courseDetail.isZero(item)}"
                           ng-if="courseDetail.progress.grades.length > 0"
                           modifier="longdivider" tappable ng-repeat="item in courseDetail.progress.grades|limitTo:courseDetail.limit">
                <div class="center">
                    <div class="progress-report course-row">
                        <div class="title">{{item.assignment.title}}</div>
                        <div class="category">{{item.assignment.categoryName}}</div>
                        <div class="progress-due-date">
                            <span translate>Due:</span> {{item.assignment.dueDate|truncate:10|date:"MMM d, y" : "UTC"}}
                            <span class="seperator" ng-show="hasComment(item)">-</span>
                            <span class="comment" ng-show="hasComment(item)"><span class="icon-comment"></span>{{item.comment}}</span>
                        </div>
                    </div>
                </div>
                <div class="right">
                    <div class="course-grades">
                        <div ng-if="courseDetail.isZero(item)" class="course-detail-grade" translate>Zero</div>
                        <div ng-if="!courseDetail.isZero(item)" class="course-detail-grade">{{item.percentScore}}</div>
                        <div class="course-score">{{item.score}}</div>
                    </div>
                </div>
            </ons-list-item>
        </div>
    </ons-list>
</ons-page>
